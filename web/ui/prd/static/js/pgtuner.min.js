function syncNumberToSlider(e){let t=document.getElementById(e+"_range"),n=document.getElementById(e),o=Math.min(Math.max(n.min,n.value),n.max);t.value=o,n.value=o}function syncSliderToNumber(e){let t=document.getElementById(e+"_range"),n=document.getElementById(e),o=Math.min(Math.max(t.min,t.value),t.max);n.value=o,t.value=o}function syncLabelFromCheckbox(e,t,n){document.getElementById(e).addEventListener("change",function(){this.checked?this.nextElementSibling.textContent=t:this.nextElementSibling.textContent=n})}function _get_kernel_memory(){let e=document.getElementById("operating_system").value,t=document.getElementById("base_kernel_memory_usage_in_mib"),n=1*t.value;return -1===n&&(n="linux"===e?768:"windows"===e?2048:64),n}function _get_monitoring_memory(){let e=document.getElementById("operating_system").value,t=document.getElementById("base_monitoring_memory_usage_in_mib"),n=1*t.value;return -1===n&&(n=256,"containerd"===e?n=64:"PaaS"===e&&(n=0)),n}function _get_total_ram(){let e=document.getElementById("operating_system").value,t=document.getElementById("add_system_reserved_memory_into_ram"),n=1024*document.getElementById("ram_sample_in_gib").value;return t.checked&&("linux"===e?n+=128:"windows"===e?n+=256:"containerd"===e&&(n+=32)),n}function ram_calculator(){let e=_get_kernel_memory(),t=_get_monitoring_memory(),n=_get_total_ram(),o=n-e-t,r=document.getElementById("total_usable_ram");return r.value=o,o<1536&&alert("The remaining memory is less than 1.5 GiB. Please consider to increase the total RAM of your server, or switch to a more lightweight monitoring system, kernel usage, or even the operating system"),o}ram_calculator();const checkboxList=document.querySelectorAll(".form-check-input");checkboxList.forEach(e=>{syncLabelFromCheckbox(e.id,"Yes","No")});const popoverTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]')),popoverList=popoverTriggerList.map(e=>new bootstrap.Popover(e));function preprocessParameters(e){let t={};for(let[n,o]of Object.entries(e))if(n.includes(".")){let r=n.split("."),l=t;for(let a=0;a<r.length;a++){let s=r[a];a===r.length-1?l[s]=o:(l[s]=l[s]||{},l=l[s])}}else t[n]=o;return t}function gatherFormValues(){let e=document.querySelectorAll("[name]"),t={};e.forEach(e=>{"range"===e.type||"number"===e.type?t[e.name]=e.step.includes(".")?parseFloat(e.value):parseInt(e.value):"text"===e.type?t[e.name]=e.value:"select-one"===e.type&&(t[e.name]=e.value)});let n=document.querySelectorAll('input[type="checkbox"]');return n.forEach(e=>{t[e.id]=e.checked}),t}function update_response(e,t){let n=document.getElementById(e);console.log(n),n.readOnly?(n.readOnly=!1,n.innerHTML="",n.innerHTML=t,n.readOnly=!0):n.innerHTML=t}async function submitConfiguration(){let e=gatherFormValues(),t=preprocessParameters(e),n={user_options:t,alter_style:document.getElementById("alter_style").checked,backup_settings:document.getElementById("backup_settings").checked,analyze_with_full_connection_use:document.getElementById("analyze_with_full_connection_use").checked,output_format:document.getElementById("output_format").value};n=JSON.stringify(n,null,2),console.log(n);try{let o=await fetch("/tune",{method:"POST",headers:{"Content-Type":"application/json"},body:n}),r=document.getElementById("output_format").value;if(o.ok){if(o.headers.get("content-type").includes("application/json")){let l=await o.json();"json"===r?update_response("response-box",JSON.stringify(l.config,null,2)):update_response("response-box",l.config),update_response("mem-report",l.mem_report)}else if(o.headers.get("content-type").includes("text/plain")){let a=await o.text();update_response("response-box",a)}}else{let s=await o.json();update_response("response-box",JSON.stringify(s.detail,null,2)),console.error("Error:",s)}}catch(i){update_response("response-box",i),console.error("Request failed:",i)}}function copyToClipboard(){let e=document.getElementById("response-box");e.select(),document.execCommand("copy"),alert("Response copied to clipboard!")}function downloadResponse(){let e=document.getElementById("response-box"),t=new Blob([e.value],{type:"text/plain"}),n=URL.createObjectURL(t),o=document.createElement("a");o.href=n,o.download="response.txt",o.click(),URL.revokeObjectURL(n)}