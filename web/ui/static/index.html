<!DOCTYPE html>
<!-- USE https://kangax.github.io/html-minifier/ to minimize HTML and https://www.toptal.com/developers/html-minifier to minify the JS-->

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <title>PGTuner - Automatic PostgreSQL Tuning Tool</title>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
          rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href="/static/favicon.ico" rel="icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script crossorigin="anonymous"
            integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
            src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
</head>

<!-- Include Bootstrap JS at the end of the body (ensure proper collapse and interactivity) -->
<header class="py-3" style="background: linear-gradient(to bottom, #f207b8, #f564e9);">
    <div class="container d-flex justify-content-between align-items-center">
        <!-- Logo and Tool Name -->
        <div class="d-flex align-items-center">
            <img alt="PGTuner Logo" class="me-2" src="/static/icon.png"
                 style="width: 40px; height: 40px;">
            <div>
                <h1 class="h4 mb-0 text-white">PGTuner</h1>
                <small class="text-light">Extensive PostgreSQL optimization</small>
            </div>
        </div>

        <!-- Navigation Links and Toggle -->
        <nav class="d-flex align-items-center">
            <ul class="nav me-3">
                <li class="nav-item">
                    <a class="nav-link text-white fw-bold" href="/">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link text-white fw-bold" href="https://github.com/your-repo-link" target="_blank">
                        <i class="bi bi-github mx-1"></i>
                        Contribute
                    </a>
                </li>
            </ul>
            <!-- Light/Dark Mode Toggle -->
            <!-- <button class="btn btn-light" id="theme-toggle">Light Mode</button> -->
        </nav>
    </div>
</header>
<body>
<div class="container my-4">
    <h2 class="mb-4">PGTuner Input Form</h2>

    <!-- Workload and Optimization Mode -->
    <div class="my-4">
        <h4 class="mb-3">Workload and Optimization Mode</h4>
        <div class="row">
            <!-- Workload Type -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="workload_type"> Workload Type </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the workload type for system tuning. The choice of workload type can impact some parameters, especially during the correction tuning and its associated risk level"
                       title="Workload Type">
                    </i>
                </div>
                <select class="form-select" id="workload_type" name="workload_type">
                    <option value="soltp">SOLTP: Single-User or Simple OLTP </option>
                    <option value="log">LOG: Logging or Log Data Ingestion</option>
                    <option value="tst">TST: Time Series Data of OLTP or IoT</option>
                    <option value="oltp">OLTP: Online Transaction Processing</option>
                    <option selected value="htap">HTAP: Hybrid Transactional/Analytical Processing</option>
                    <option value="tsh">TSH: Time-Series of Analytic and Transaction</option>
                    <option value="olap">OLAP: Online Analytical Processing</option>
                    <option value="tsa">TSA: Time-Series of OLAP</option>
                    <option value="dw">DW: Data Warehouse</option>
                    <option value="dl">DL: Data Lake</option>
                    <option value="search">Search: Full-Text Search and Indexing</option>
                    <option value="rag">RAG: Retrieval-Augmented Generation</option>
                    <option value="geo">Geo: Geospatial Data</option>
                </select>
            </div>
            <!-- Optimization Mode -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="opt_memory"> Memory Optimization Mode </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The PostgreSQL optimization mode on workload type to tune memory usage by allowing total disk cache (effective_cache_size) in buffer to higher ratio (shared_buffers + effective_cache_size + wal_buffers + dedicated memory of connection to be approximate the RAM)"
                       title="Memory Optimization Mode">
                    </i>
                </div>
                <select class="form-select" id="opt_memory" name="opt_memory">
                    <option value="none">NONE: Ignore Optimization </option>
                    <option value="lightweight">SPIDEY: Light-weight Optimization</option>
                    <option selected value="general">OPTIMUS PRIME: General Optimization </option>
                    <option value="aggressive">PRIMORDIAL: Extreme Optimization</option>
                </select>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="opt_memory_precision"> Memory Precision Optimization Mode </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="If not NONE, it would proceed the extra tuning to increase the memory usage to reach to your expectation (shared_buffers, work_mem, temp_buffer, wal_buffer, ...). Set to SPIDEY use the worst case of memory usage by assuming all connections are under high load. Set to OPTIMUS_PRIME (default) take the average between normal (active connections) and worst case as the stopping condition; PRIMORDIAL take the normal case as the stopping condition."
                       title="Memory Precision Optimization Mode">
                    </i>
                </div>
                <select class="form-select" id="opt_memory_precision" name="opt_memory_precision">
                    <option value="none">NONE: Ignore Optimization </option>
                    <option value="lightweight">SPIDEY: Light-weight Optimization</option>
                    <option selected value="general">OPTIMUS PRIME: General Optimization </option>
                    <option value="aggressive">PRIMORDIAL: Extreme Optimization</option>
                </select>
            </div>
            <!-- Operating System and its Specification (CPU, RAM) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="operating_system"> Operating System </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The operating system that the PostgreSQL server is running on. Default is Linux. If the memory usage of kernel and monitoring is set to -1, the system would self-calculate your basic RAM usage based on the developer testing. To minimize its estimation, set the memory usage of kernel and monitoring to 0 bytes"
                       title="Operating System">
                    </i>
                </div>
                <select class="form-select" id="operating_system" name="operating_system">
                    <option selected value="linux">Linux</option>
                    <option value="windows">Windows</option>
                    <option value="macos">macOS</option>
                    <option value="docker">Docker</option>
                    <option value="k8s">Kubernetes</option>
                    <option value="containerd">Containerd</option>
                    <option value="wsl">WSL</option>
                    <option value="PaaS">PaaS (Cloud or 3rd-Party)</option>
                    <option value="DBaaS">DBaaS (Cloud or 3rd-Party)</option>
                </select>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="vcpu_sample"> Number of vCPUs </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the number of logical CPUs for system tuning. This can bond together with the CPU profile"
                       title="Number of vCPUs">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="vcpu_sample" id="vcpu_sample_range"
                           max="128" min="1" step="1" value="4" type="range"
                           placeholder="Enter the number of logical CPUs"
                           onchange="syncSliderToNumber('vcpu_sample')">
                    <input class="form-control w-25" id="vcpu_sample"
                            max="128" min="1" step="1" value="4" type="number"
                            onchange="syncNumberToSlider('vcpu_sample')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="ram_sample_in_gib"> RAM Size (GiB) </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto" data-text-align="justify"
                       data-bs-content="Select the RAM size for system tuning. This can bond together with the Memory profile. However, please ensure that the RAM must be larger than total RAM in use. For the PostgreSQL database the minimum memory should be larger than 4 GiB (recommended to be larger than 8 GiB)."
                       title="RAM Size">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="ram_sample_in_gib" id="ram_sample_in_gib_range"
                           max="1024" min="1" step="0.25" value="16" type="range"
                           onchange="syncSliderToNumber('ram_sample_in_gib')">
                    <input class="form-control w-50" id="ram_sample_in_gib"
                            max="1024" min="1" step="0.25" value="16" type="number"
                            onchange="syncNumberToSlider('ram_sample_in_gib')">
                </div>
            </div>
            <!-- RAM usage in basic (OS and Monitoring) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="add_system_reserved_memory_into_ram">Add System Reserved Memory into RAM </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Add system reserved memory into RAM. Only enable this if you take the value *directly* the operating system by measurement (free -m on Linux, Task Manager on Windows, etc), as this would add a small amount of memory into the estimation depending on the operating system. However, we do not recommend to set this as it could assume your PostgreSQL can use the reserved memory which are already dedicated for the kernel, booting process, and other system processes."
                       title="Add System Reserved Memory into RAM">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="add_system_reserved_memory_into_ram" >
                    <label class="form-check-label px-3" for="add_system_reserved_memory_into_ram">No</label>
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="base_kernel_memory_usage_in_mib">Kernel Memory Usage (MiB)</label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Enter the kernel memory when idle in MiB. Default value is -1 would make pgtuner to perform estimation based on the OS. Set to 0 to disable. If you have measured the kernel memory then set to the value you have measured. But ensure that the RAM capacity must be larger than this kernel and monitoring memory usage."
                       title="Kernel Memory Usage (MiB)">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="base_kernel_memory_usage_in_mib" id="base_kernel_memory_usage_in_mib_range"
                           max="8192" min="-1" step="1" value="-1" type="range"
                           onchange="syncSliderToNumber('base_kernel_memory_usage_in_mib')">
                    <input class="form-control w-50" id="base_kernel_memory_usage_in_mib"
                           max="8192" min="-1" step="1" value="-1" type="number"
                           onchange="syncNumberToSlider('base_kernel_memory_usage_in_mib')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="base_monitoring_memory_usage_in_mib">Monitoring Memory Usage (MiB) </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Enter the monitoring memory when idle in MiB. Default value is -1 would make pgtuner to perform estimation based on the OS. Set to 0 to disable. If you have measured the monitoring memory then set to the value you have measured. But ensure that the RAM capacity must be larger than this kernel and monitoring memory usage."
                       title="Monitoring Memory Usage (MiB)">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="base_monitoring_memory_usage_in_mib" id="base_monitoring_memory_usage_in_mib_range"
                           max="4096" min="-1" step="1" value="-1" type="range"
                           onchange="syncSliderToNumber('base_monitoring_memory_usage_in_mib')">
                    <input class="form-control w-50" id="base_monitoring_memory_usage_in_mib"
                            max="4096" min="-1" step="1" value="-1" type="number"
                            onchange="syncNumberToSlider('base_monitoring_memory_usage_in_mib')">
                </div>
            </div>
        </div>
    </div>

    <!-- System Profiles -->
    <div class="my-4">
        <h4 class="mb-3">System Profiles</h4>
        <div class="row">
            <!-- Overall Profile -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="workload_profile"> Workload Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the workload profile for system tuning. Higher profile means that the amount of data change is larger, with more running queries and connections, ... This is also the default if the supplied value for CPU, MEM, DISK, and NET is not in supported value."
                       title="Workload profile">
                    </i>
                </div>
                <select class="form-select" id="workload_profile" name="workload_profile">
                    <option value="mini">Mini: Self-hosted or Development</option>
                    <option value="medium">Medium: Mini website or Small internal usage</option>
                    <option selected value="large">Large: City-level Scale </option>
                    <option value="mall">Mall: Metropolis-level or Country-level Scale</option>
                    <option value="bigt">BigTech: Multinational-level Scale</option>
                </select>
            </div>
            <!-- CPU Profile (Similar format) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="cpu_profile"> CPU Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the CPU profile for profile-based tuning during the general phase, regardless the number of logical CPU. It is recommended to set this value matched with your number of vCPU to prevent throttle or under-utilization. 1-4 : Mini -> 2-8 : Medium -> 6-16 : Large -> 12-48 : Mall -> 32-128 : BigTech"
                       title="CPU profile">
                    </i>
                </div>
                <select class="form-select" id="cpu_profile" name="cpu_profile">
                    <option value="mini">Mini: Self-hosted or Development</option>
                    <option value="medium">Medium: Mini website or Small internal usage</option>
                    <option selected value="large">Large: City-level Scale </option>
                    <option value="mall">Mall: Metropolis-level or Country-level Scale</option>
                    <option value="bigt">BigTech: Multinational-level Scale</option>
                </select>
            </div>
            <!-- Memory Profile (Similar format) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="mem_profile"> Memory Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the memory profile for profile-based tuning during the general phase, regardless the number of RAM. It is recommended to set this value matched with your RAM capacity to prevent throttle or under-utilization. For the database workload, it is best to have the vCPU:RAM to be at least 1:4 (1:6 or 1:8 are preferred when the workload is read-heavy with low number of connections). 2-16 : Mini -> 8-32 : Medium -> 24-64 : Large -> 48-192 : Mall -> 128-512 : BigTech"
                       title="Memory profile">
                    </i>
                </div>
                <select class="form-select" id="mem_profile" name="mem_profile">
                    <option value="mini">Mini: Self-hosted or Development</option>
                    <option value="medium">Medium: Mini website or Small internal usage</option>
                    <option selected value="large">Large: City-level Scale </option>
                    <option value="mall">Mall: Metropolis-level or Country-level Scale</option>
                    <option value="bigt">BigTech: Multinational-level Scale</option>
                </select>
            </div>
            <!-- Disk Profile (Similar format) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="disk_profile"> Disk Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the disk profile for profile-based tuning during the general phase, regardless the disk capacity. However, in almost of the PostgreSQL tunable settings, this does not contribute to any available settings but we leave the option for future development."
                       title="Disk profile">
                    </i>
                </div>
                <select class="form-select" id="disk_profile" name="disk_profile">
                    <option value="mini">Mini: Self-hosted or Development</option>
                    <option value="medium">Medium: Mini website or Small internal usage</option>
                    <option selected value="large">Large: City-level Scale </option>
                    <option value="mall">Mall: Metropolis-level or Country-level Scale</option>
                    <option value="bigt">BigTech: Multinational-level Scale</option>
                </select>
            </div>
            <!-- Network Profile (Similar format) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="net_profile"> Network Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the network profile for profile-based tuning during the general phase, regardless the network speed. However, in almost of the PostgreSQL tunable settings, this does not contribute to any available settings but we leave the option for future development. This option are mainly used for the kernel (sysctl) tuning and network monitoring, but the tuning does not available in the website and its codebase for automatic tuning is limited. < 500 Mbps : Mini -> < 1000 Mbps  : Medium -> < 5000 Mbps : Large -> < 12500 Mbps : Mall -> < 30000 Mbps : BigTech"
                       title="Network profile">
                    </i>
                </div>
                <select class="form-select" id="net_profile" name="net_profile">
                    <option value="mini">Mini: Self-hosted or Development</option>
                    <option value="medium">Medium: Mini website or Small internal usage</option>
                    <option selected value="large">Large: City-level Scale </option>
                    <option value="mall">Mall: Metropolis-level or Country-level Scale</option>
                    <option value="bigt">BigTech: Multinational-level Scale</option>
                </select>
            </div>
            <!-- PostgreSQL Version (Similar format) -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="pgsql_version">PostgreSQL Version</label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the PostgreSQL version for system tuning. Supported versions are 13 -> 17 (latest)"
                       title="PostgreSQL version">
                    </i>
                </div>
                <select class="form-select" id="pgsql_version" name="pgsql_version">
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option selected value="latest">latest</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Disk and WAL Specifications -->
    <div class="my-4">
        <h4 class="mb-3">Disk: Data and WAL Specifications</h4>
        <p class="mb-3"> Warning: If you are using RAID, please ensure below calculation are suitable for RAID0 where READ and WRITE
            can be scaled equally (not linearly) and all disks has same capacity. If you are wandering if these calculations
            are correct, benchmark your whole volume in throughput (MiB/s) and random IOPS (with 8KiB page size) and
            set the number of disks to be 1 to disable the RAID estimation.
        </p>

        <div class="row">
            <h5> Data & Index Partition/Volume </h5>
            <!-- Single disk performance: Random IOPS (8K) or throughput -->
            <!-- Random IOPS (mainly used) -->
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.random_iops"> Random IOPS (8K-IO) </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The number of random 8K-IOPS of the volume or single disk."
                       title="Random IOPS (8K-IO)">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="data_index_spec.random_iops" id="data_index_spec.random_iops_range"
                           max="1400000" min="50" step="10" value="30000" type="range"
                           onchange="syncSliderToNumber('data_index_spec.random_iops')">
                    <input class="form-control w-25" id="data_index_spec.random_iops"
                           max="1400000" min="50" step="10" value="30000" type="number"
                           onchange="syncNumberToSlider('data_index_spec.random_iops')">
                </div>
            </div>
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.random_iops_scale_factor"> Random IOPS Scale Factor </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The random IOPS scale factor of the volume or single disk. Set to 0.95-1.0 when you have measured the real performance (0.95 to plan for future growth). We do not recommend use the manufacturer's specification as it is not a real indicator, but even if so, a good default is set to 0.9 for bare metal and 0.8 for virtualization or containerization environment."
                       title="Random IOPS Scale Factor ">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="data_index_spec.random_iops_scale_factor"
                           id="data_index_spec.random_iops_scale_factor_range"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="range"
                           onchange="syncSliderToNumber('data_index_spec.random_iops_scale_factor')">
                    <input class="form-control w-25" id="data_index_spec.random_iops_scale_factor"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="number"
                           onchange="syncNumberToSlider('data_index_spec.random_iops_scale_factor')">
                </div>
            </div>
            <!-- Throughput -->
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.throughput"> Throughput (MB/s)</label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The throughput (MB/s) of the volume or single disk."
                       title="Throughput (MB/s) ">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="data_index_spec.throughput"
                           id="data_index_spec.throughput_range"
                           max="14000" min="50" step="10" value="500" type="range"
                           onchange="syncSliderToNumber('data_index_spec.throughput')">
                    <input class="form-control w-25" id="data_index_spec.throughput"
                            max="14000" min="50" step="10" value="500" type="number"
                            onchange="syncNumberToSlider('data_index_spec.throughput')">
                </div>
            </div>
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.throughput_scale_factor"> Throughput Scale Factor </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The throughput scale factor of the volume or single disk. Set to 0.95-1.0 when you have measured the real performance (0.95 to plan for future growth). We do not recommend use the manufacturer's specification as it is not a real indicator, but even if so, a good default is set to 0.9 for bare metal and 0.8 for virtualization or containerization environment."
                       title="Throughput Scale Factor">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="data_index_spec.throughput_scale_factor"
                           id="data_index_spec.throughput_scale_factor_range"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="range"
                           onchange="syncSliderToNumber('data_index_spec.throughput_scale_factor')">
                    <input class="form-control w-25" id="data_index_spec.throughput_scale_factor"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="number"
                           onchange="syncNumberToSlider('data_index_spec.throughput_scale_factor')">
                </div>
            </div>
            <!-- Disk Size (5 GiB -> 64 TiB), Number of Disks in Volume (1 -> 64) , Disk Scale in RAID0 (0.0 -> 1.0): Use col-4 -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.disk_usable_size_in_gib"> Total Volume Size (GiB) </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The total volume size of (measured in GiB). This is independent of the number of disks"
                       title="Total Volume Size (GiB) ">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="data_index_spec.disk_usable_size_in_gib"
                           id="data_index_spec.disk_usable_size_in_gib_range"
                           max="65536" min="5" step="1" value="100" type="range"
                           onchange="syncSliderToNumber('data_index_spec.disk_usable_size_in_gib')">
                    <input class="form-control w-auto" id="data_index_spec.disk_usable_size_in_gib"
                           max="65536" min="5" step="1" value="100" type="number"
                           onchange="syncNumberToSlider('data_index_spec.disk_usable_size_in_gib')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.num_disks"> Number of Homo-Disks in RAID0 Volume </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The number of disks in the volume. Default to 1. Note that if they are in RAID0 configuration, the diminishing return law based on controller bandwidth, interface bandwidth, workload characteristics, drive performance variability, CPU overhead, RAID controller software reservations and overhead, and so on. In general, the diminishing return law in RAID(0) is met when going beyond 8 disks (result varied between disk quality and RAID controller)."
                       title="Number of Disks in RAID0 Volume">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-2" name="data_index_spec.num_disks" id="data_index_spec.num_disks_range"
                           max="24" min="1" step="1" value="1" type="range"
                           onchange="syncSliderToNumber('data_index_spec.num_disks')">
                    <input class="form-control w-auto" id="data_index_spec.num_disks"
                           max="24" min="1" step="1" value="1" type="number"
                           onchange="syncNumberToSlider('data_index_spec.num_disks')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="data_index_spec.per_scale_in_raid"> RAID0 Performance Scale Ratio </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The performance scale ratio in RAID0. Default to 0.75 meant that for each disk drive added into the RAID, you can only achieve maximum 75% more of its performance and it would be degraded overtime due to the diminishing return. For example, with 75% efficiency, 2 disks would gain 1.75x performance, 3 disks is 2.5x, 8 disks is 5.25x"
                       title="RAID0 Performance Scale Ratio">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-2" name="data_index_spec.per_scale_in_raid"
                           id="data_index_spec.per_scale_in_raid_range"
                           max="1.0" min="0.0" step="0.01" value="0.75" type="range"
                           onchange="syncSliderToNumber('data_index_spec.per_scale_in_raid')">
                    <input class="form-control w-auto" id="data_index_spec.per_scale_in_raid"
                           max="1.0" min="0.0" step="0.01" value="0.75" type="number"
                           onchange="syncNumberToSlider('data_index_spec.per_scale_in_raid')">
                </div>
            </div>
        </div>

        <div class="row">
            <h5 class="mb-3">WAL Partition/Volume</h5>
            <!-- Single disk performance: Random IOPS (8K) or throughput -->
            <!-- Random IOPS -->
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.random_iops"> Random IOPS (8K-IO) </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The number of random 8K-IOPS of the volume or single disk."
                       title="Random IOPS (8K-IO)">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="wal_spec.random_iops" id="wal_spec.random_iops_range"
                           max="1400000" min="50" step="10" value="30000" type="range"
                           onchange="syncSliderToNumber('wal_spec.random_iops')">
                    <input class="form-control w-25" id="wal_spec.random_iops"
                           max="1400000" min="50" step="10" value="30000" type="number"
                           onchange="syncNumberToSlider('wal_spec.random_iops')">
                </div>
            </div>
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.random_iops_scale_factor"> Random IOPS Scale Factor </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The random IOPS scale factor of the volume or single disk. Set to 0.95-1.0 when you have measured the real performance (0.95 to plan for future growth). We do not recommend use the manufacturer's specification as it is not a real indicator, but even if so, a good default is set to 0.9 for bare metal and 0.8 for virtualization or containerization environment."
                       title="Random IOPS Scale Factor ">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="wal_spec.random_iops_scale_factor"
                           id="wal_spec.random_iops_scale_factor_range"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="range"
                           onchange="syncSliderToNumber('wal_spec.random_iops_scale_factor')">
                    <input class="form-control w-25" id="wal_spec.random_iops_scale_factor"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="number"
                           onchange="syncNumberToSlider('wal_spec.random_iops_scale_factor')">
                </div>
            </div>
            <!-- Throughput -->
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.throughput"> Throughput (MB/s)</label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The throughput (MB/s) of the volume or single disk."
                       title="Throughput (MB/s) ">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="wal_spec.throughput" id="wal_spec.throughput_range"
                           max="14000" min="50" step="10" value="500" type="range"
                           onchange="syncSliderToNumber('wal_spec.throughput')">
                    <input class="form-control w-25" id="wal_spec.throughput"
                           max="14000" min="50" step="10" value="500" type="number"
                           onchange="syncNumberToSlider('wal_spec.throughput')">
                </div>
            </div>
            <div class="col-6 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.throughput_scale_factor"> Throughput Scale Factor </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The throughput scale factor of the volume or single disk. Set to 0.95-1.0 when you have measured the real performance (0.95 to plan for future growth). We do not recommend use the manufacturer's specification as it is not a real indicator, but even if so, a good default is set to 0.9 for bare metal and 0.8 for virtualization or containerization environment."
                       title="Throughput Scale Factor">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="wal_spec.throughput_scale_factor"
                           id="wal_spec.throughput_scale_factor_range"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="range"
                           onchange="syncSliderToNumber('wal_spec.throughput_scale_factor')">
                    <input class="form-control w-25" id="wal_spec.throughput_scale_factor"
                           max="1.0" min="0.0" step="0.01" value="0.9" type="number"
                           onchange="syncNumberToSlider('wal_spec.throughput_scale_factor')">
                </div>
            </div>
            <!-- Disk Size (5 GiB -> 64 TiB), Number of Disks in Volume (1 -> 64) , Disk Scale in RAID0 (0.0 -> 1.0): Use col-4 -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.disk_usable_size_in_gib"> Total Volume Size (GiB) </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The total volume size of (measured in GiB). This is independent of the number of disks"
                       title="Total Volume Size (GiB) ">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="wal_spec.disk_usable_size_in_gib"
                           id="wal_spec.disk_usable_size_in_gib_range"
                           max="65536" min="5" step="1" value="100" type="range"
                           onchange="syncSliderToNumber('wal_spec.disk_usable_size_in_gib')">
                    <input class="form-control w-auto" id="wal_spec.disk_usable_size_in_gib"
                           max="65536" min="5" step="1" value="100" type="number"
                           onchange="syncNumberToSlider('wal_spec.disk_usable_size_in_gib')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.num_disks"> Number of Homo-Disks in RAID0 Volume </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The number of disks in the volume. Default to 1. Note that if they are in RAID0 configuration, the diminishing return law based on controller bandwidth, interface bandwidth, workload characteristics, drive performance variability, CPU overhead, RAID controller software reservations and overhead, and so on. In general, the diminishing return law in RAID(0) is met when going beyond 8 disks (result varied between disk quality and RAID controller)."
                       title="Number of Disks in RAID0 Volume">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-2" name="wal_spec.num_disks" id="wal_spec.num_disks_range"
                           max="24" min="1" step="1" value="1" type="range"
                           onchange="syncSliderToNumber('wal_spec.num_disks')">
                    <input class="form-control w-auto" id="wal_spec.num_disks"
                           max="24" min="1" step="1" value="1" type="number"
                           onchange="syncNumberToSlider('wal_spec.num_disks')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="wal_spec.per_scale_in_raid"> RAID0 Performance Scale Ratio </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The performance scale ratio in RAID0. Default to 0.75 meant that for each disk drive added into the RAID, you can only achieve maximum 75% more of its performance and it would be degraded overtime due to the diminishing return. For example, with 75% efficiency, 2 disks would gain 1.75x performance, 3 disks is 2.5x, 8 disks is 5.25x"
                       title="RAID0 Performance Scale Ratio">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-2" name="wal_spec.per_scale_in_raid"
                           id="wal_spec.per_scale_in_raid_range"
                           max="1.0" min="0.0" step="0.01" value="0.75" type="range"
                           onchange="syncSliderToNumber('wal_spec.per_scale_in_raid')">
                    <input class="form-control w-auto" id="wal_spec.per_scale_in_raid"
                           max="1.0" min="0.0" step="0.01" value="0.75" type="number"
                           onchange="syncNumberToSlider('wal_spec.per_scale_in_raid')">
                </div>
            </div>
        </div>
    </div>

    <!-- Data Integrity, Transaction, Crash Recovery, and Replication -->
    <div class="my-4">
        <h4 class="mb-3">Data Integrity, Transaction Efficiency, Crash Recovery, and Replication</h4>
        <div class="row">
            <!-- Data Integrity with Tools and Replication -->
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="max_backup_replication_tool"> Max Level of Backup & Replication Tool </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select the maximum level of backup and replication tool for system tuning. This argument is also helps to set the wal_level variable. The level of wal_level can be determined by maximum of achieved replication tool and number of replicas but would not impact on the data/transaction integrity choice."
                       title="Max Level of Backup & Replication Tool">
                    </i>
                </div>
                <select class="form-select" id="max_backup_replication_tool" name="max_backup_replication_tool">
                    <option value="disk_snapshot">0: Backup by Disk Snapshot</option>
                    <option value="pg_dump">1: pg_dump/pg_dumpall for logical-textual backup</option>
                    <option value="pg_basebackup">2: pg_basebackup [--incremental] or streaming replication (byte-capture change): Byte-level backup</option>
                    <option value="pg_logical">3: pg_logical and alike: Logical replication</option>
                </select>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="opt_transaction_lost">Transaction Optimization Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The PostgreSQL mode for allow the transaction loss to tune the transaction loss recovery mechanism. If you are working in on the mission-critical system where the atomicity and consistency are the top priorities, then set to NONE (default) to not allow the lost transaction loss by change the synchronous_commit. Set to SPIDEY would convert the synchronous_commit to off, local, or remote_write (depending on the wal_level and number of replicas). Set to OPTIMUS_PRIME would convert the full_page_writes to off. Set to PRIMORDIAL would convert the fsync to off. Use with your own risk and caution."
                       title="Transaction Optimization Profile">
                    </i>
                </div>
                <select class="form-select" id="opt_transaction_lost" name="opt_transaction_lost">
                    <option selected value="none">NONE: Ignore Optimization </option>
                    <option value="lightweight">SPIDEY: Light-weight Optimization</option>
                    <option value="general">OPTIMUS PRIME: General Optimization </option>
                    <option value="aggressive">PRIMORDIAL: Extreme Optimization</option>
                </select>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="opt_wal_buffers">WAL Buffer Optimization Profile </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Higher profile would reduce the maximum space for WAL buffers. Default to NONE means we reuse the value taken from the general tuning phase. Switch to SPIDEY would cap its maximum to a lower value (defined when the wal_level is minimal). Increase to OPTIMUS_PRIME would half the value return from the general tuning phase, but ensuring the WAL buffers minimum to be the size of a WAL segment (16 MiB). Increase to PRIMORDIAL would set the WAL buffers to zero. Unless you are working in on the mission-critical system where the atomicity and consistency are the top priorities; otherwise, we recommended to use the value equal or below the OPTIMUS_PRIME. This flag is not being impacted regardless the wal_level value."
                       title="WAL Buffer Optimization Profile">
                    </i>
                </div>
                <select class="form-select" id="opt_wal_buffers" name="opt_wal_buffers">
                    <option selected value="none">NONE: Ignore Optimization </option>
                    <option value="lightweight">SPIDEY: Light-weight Optimization</option>
                    <option value="general">OPTIMUS PRIME: General Optimization </option>
                    <option value="aggressive">PRIMORDIAL: Extreme Optimization</option>
                </select>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="max_num_stream_replicas_on_primary">
                        How many stream replicas you attempted to made? </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The number of stream replicas you attempted to made."
                       title="Maximum number of streaming replicas on the primary server">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="max_num_stream_replicas_on_primary"
                           id="max_num_stream_replicas_on_primary_range"
                           max="32" min="0" step="1" value="0" type="range"
                           onchange="syncSliderToNumber('max_num_stream_replicas_on_primary')">
                    <input class="form-control w-auto" id="max_num_stream_replicas_on_primary"
                            max="32" min="0" step="1" value="0" type="number"
                            onchange="syncNumberToSlider('max_num_stream_replicas_on_primary')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="max_num_logical_replicas_on_primary">
                        How many logical replicas you attempted to made? </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The number of logical replicas you attempted to made."
                       title="Maximum number of logical replicas on the primary server">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="max_num_logical_replicas_on_primary"
                           id="max_num_logical_replicas_on_primary_range"
                           max="32" min="0" step="1" value="0" type="range"
                           onchange="syncSliderToNumber('max_num_logical_replicas_on_primary')">
                    <input class="form-control w-auto" id="max_num_logical_replicas_on_primary"
                            max="32" min="0" step="1" value="0" type="number"
                            onchange="syncNumberToSlider('max_num_logical_replicas_on_primary')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="max_time_transaction_loss_allow_in_millisecond">
                        Maximum Allow Time for Transaction Loss (ms)
                    </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="The maximum time (in milli-second) that user allow for transaction loss, to flush the page in memory to WAL partition by WAL writer. The supported range is [1, 10000] and default is 650 (translated to the default 200ms or 3.25x of wal_writer_delay). The lost ratio is twice the value and three times in worst case (so we buffer to 3.25x) because the WAL writer is designed to favor writing whole pages at a time during busy periods. The wal_writer_delay can only be impacted when wal_level is set to replica and higher."
                       title="Maximum Time in Millisecond for Transaction Loss Allowance">
                    </i>
                </div>
                <div class="d-flex align-items-center">
                    <input class="form-range me-3" name="max_time_transaction_loss_allow_in_millisecond"
                           id="max_time_transaction_loss_allow_in_millisecond_range"
                           max="10000" min="1" step="1" value="650" type="range"
                           onchange="syncSliderToNumber('max_time_transaction_loss_allow_in_millisecond')">
                    <input class="form-control w-auto" id="max_time_transaction_loss_allow_in_millisecond"
                            max="10000" min="1" step="1" value="650" type="number"
                            onchange="syncNumberToSlider('max_time_transaction_loss_allow_in_millisecond')">
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="repurpose_wal_buffers">
                       Transfer WAL buffers to Working Memory
                    </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Set to True (default) would take the difference of WAL buffers to be used in temp_buffers and work_mem, by increasing its pool size. This would be conducted after the final memory tuning. The reason not to re-purpose into the shared_buffers is that the shared_buffers is usually persistent when the database is online. This argument is only valid when the opt_wal_buffers is set to SPIDEY or higher."
                       title="Transfer WAL buffers to Working Memory">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="repurpose_wal_buffers" checked >
                    <label class="form-check-label px-3" for="repurpose_wal_buffers">Yes</label>
                </div>
            </div>
            <div class="col-4 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="offshore_replication">
                       Offshore Replication (regional or international)
                    </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="If set it to True, you are wishing to have an geo-replicated replicas in the offshore country or continent. Enable it would increase the wal_sender_timeout to 2 minutes or more."
                       title="Offshore Replication">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="offshore_replication" >
                    <label class="form-check-label px-3" for="offshore_replication">No</label>
                </div>
            </div>
        </div>
    </div>

    <!-- User Tuning Options -->
    <div class="my-4">
        <h4 class="mb-3">Tuning Mode</h4>
        <div class="row">
            <!-- Database Tuning -->
            <div class="col-3 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="enable_database_general_tuning">
                        Enable Database General Tuning
                    </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Enable database general tuning."
                       title="Enable Database General Tuning">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="enable_database_general_tuning" checked >
                    <label class="form-check-label px-3" for="enable_database_general_tuning">Yes</label>
                </div>
            </div>
            <div class="col-3 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="enable_database_correction_tuning">
                        Enable Database Correction Tuning
                    </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Enable database correction tuning."
                       title="Enable Database Correction Tuning">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="enable_database_correction_tuning" checked >
                    <label class="form-check-label px-3" for="enable_database_correction_tuning">Yes</label>
                </div>
            </div>
            <!-- Sysctl Tuning -->

            <!-- Some Query Tuning -->

        </div>
        <div class="row">
            <div class="col-3 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="alter_style"> Alter Style </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Enable it to switch the format into ALTER SYSTEM SET"
                       title="Alter Style">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="alter_style" >
                    <label class="form-check-label px-3" for="alter_style">No</label>
                </div>
            </div>
            <div class="col-3 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="backup_settings"> Backup Settings </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Enable it to add the request's information when output format is 'file'."
                       title="Backup Settings">
                    </i>
                </div>
                <div class="d-flex align-items-center form-check form-switch">
                    <input class="form-check-input" type="checkbox" role="switch" id="backup_settings" >
                    <label class="form-check-label px-3" for="backup_settings">No</label>
                </div>
            </div>
            <div class="col-3 mb-3">
                <div class="d-flex justify-content-between align-items-center">
                    <label class="form-label" for="output_format"> Output Format </label>
                    <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                       data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                       data-bs-content="Select your desired output format."
                       title="Backup Settings">
                    </i>
                </div>
                <select class="form-select" id="output_format" name="output_format">
                    <option selected value="conf">Conf: Configuration File</option>
                    <option value="json">JSON: Return JSON configuration</option>
                    <option value="text">Text: Similar to Conf but with dot-comma notion</option>
                    <option value="file">File: Fully-managed outcome</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Advanced Settings -->
    <div class="my-4">
        <h4 class="mb-3">Advanced Tuning Parameters</h4>
        <button aria-controls="advancedSettings" aria-expanded="false" class="btn btn-secondary"
                data-bs-target="#advancedSettings"
                data-bs-toggle="collapse" type="button">
            Show Advanced Settings
        </button>
        <div class="collapse" id="advancedSettings">
            <div class="card card-body my-3">
                <div class="row">
                    <!-- user_max_connections -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.user_max_connections">
                                Maximum Number of Users Connections
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The maximum number of client connections allowed (override by user). The supported range is [0, 1000], default is 0 (ignored). Unless necessary required to have large number of connections, it is best to use default and if the number of user connections exceed 100-150 then it is better to use connection pooling"
                               title="Maximum Number of Users Connections">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.user_max_connections"
                                   id="keywords.user_max_connections_range"
                                   max="1000" min="0" step="1" value="0" type="range"
                                   onchange="syncSliderToNumber('keywords.user_max_connections')">
                            <input class="form-control w-auto" id="keywords.user_max_connections"
                                   max="1000" min="0" step="1" value="0" type="number"
                                   onchange="syncNumberToSlider('keywords.user_max_connections')">
                        </div>
                    </div>
                    <!-- superuser_reserved_connections -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.superuser_reserved_connections_scale_ratio">
                                Superuser Reserved Connections Scale Ratio
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The de-scale ratio for the reserved superuser connections over the normal reserved connection. The supported range is [1, 3], default is 1.5. Higher value means the de-scale is stronger."
                               title="Superuser Reserved Connections Scale Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.superuser_reserved_connections_scale_ratio"
                                   id="keywords.superuser_reserved_connections_scale_ratio_range"
                                   max="3" min="1" step="0.1" value="1.5" type="range"
                                   onchange="syncSliderToNumber('keywords.superuser_reserved_connections_scale_ratio')">
                            <input class="form-control w-auto" id="keywords.superuser_reserved_connections_scale_ratio"
                                   max="3" min="1" step="0.1" value="1.5" type="number"
                                   onchange="syncNumberToSlider('keywords.superuser_reserved_connections_scale_ratio')">
                        </div>
                    </div>
                    <!-- single_memory_connection_overhead -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.single_memory_connection_overhead_in_kib">
                                Total Memory Used per Connection (KiB)
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The memory overhead for a single connection at idle state. The supported range is [1 MiB, 16 MiB], default is 5 MiB in total. This value is used to estimate the memory usage for each connection. We do not recommend to set this value too high as it could make the estimation to be incorrect (recommend to be in between 4 - 8 MiB)."
                               title="Total Memory Used per Connection (KiB)">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.single_memory_connection_overhead_in_kib"
                                   id="keywords.single_memory_connection_overhead_in_kib_range"
                                   max="16384" min="1024" step="256" value="5120" type="range"
                                   onchange="syncSliderToNumber('keywords.single_memory_connection_overhead_in_kib')">
                            <input class="form-control w-auto" id="keywords.single_memory_connection_overhead_in_kib"
                                   max="16384" min="1024" step="256" value="5120" type="number"
                                   onchange="syncNumberToSlider('keywords.single_memory_connection_overhead_in_kib')">
                        </div>
                    </div>
                    <!-- memory_connection_to_dedicated_os_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.memory_connection_to_dedicated_os_ratio">
                                Connection: Memory on OS Ratio
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of the memory connection to the dedicated OS memory. The supported range is [0, 1], default is 0.3. This value is used to estimate the memory usage for each connection is placed under the OS memory page rather than the shared_buffers of the PostgreSQL memory."
                               title="Memory Connection to Dedicated OS Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.memory_connection_to_dedicated_os_ratio"
                                   id="keywords.memory_connection_to_dedicated_os_ratio_range"
                                   max="1" min="0" step="0.05" value="0.3" type="range"
                                   onchange="syncSliderToNumber('keywords.memory_connection_to_dedicated_os_ratio')">
                            <input class="form-control w-auto" id="keywords.memory_connection_to_dedicated_os_ratio"
                                   max="1" min="0" step="0.05" value="0.3" type="number"
                                   onchange="syncNumberToSlider('keywords.memory_connection_to_dedicated_os_ratio')">
                        </div>
                    </div>

                    <!-- effective_cache_size_available_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.effective_cache_size_available_ratio">
                                Effective Cache Size Available Ratio
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The percentage of effective_cache_size over the total PostgreSQL available memory excluding the shared_buffers and others. The supported range is [0.93, 1.0), default is 0.99. It is recommended to set this value to at least 0.98 or higher."
                               title="Effective Cache Size Available Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.effective_cache_size_available_ratio"
                                   id="keywords.effective_cache_size_available_ratio_range"
                                   max="1.0" min="0.93" step="0.0025" value="0.99" type="range"
                                   onchange="syncSliderToNumber('keywords.effective_cache_size_available_ratio')">
                            <input class="form-control w-auto" id="keywords.effective_cache_size_available_ratio"
                                   max="1.0" min="0.93" step="0.0025" value="0.99" type="number"
                                   onchange="syncNumberToSlider('keywords.effective_cache_size_available_ratio')">
                        </div>
                    </div>
                    <!-- shared_buffers_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.shared_buffers_ratio">
                                Shared Buffers Ratio
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of shared_buffers ratio to the total non-database memory. The supported range is [0.15, 0.80), default is 0.25. If you have or prioritize the *simple* query that perform more READ (SELECT) than WRITE (INSERT/UPDATE/DELETE) between two WRITE interval in the *same* table, than you can think of increasing **slowly** this value (1-2% increment change) with consideration. However, we recommend that this value should be below 0.40 to prevent double caching unless you are making a read-only database or a not-good synthetic benchmark."
                               title="Shared Buffers Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.shared_buffers_ratio"
                                   id="keywords.shared_buffers_ratio_range"
                                   max="0.80" min="0.15" step="0.01" value="0.25" type="range"
                                   onchange="syncSliderToNumber('keywords.shared_buffers_ratio')">
                            <input class="form-control w-auto" id="keywords.shared_buffers_ratio"
                                   max="0.80" min="0.15" step="0.01" value="0.25" type="number"
                                   onchange="syncNumberToSlider('keywords.shared_buffers_ratio')">
                        </div>
                    </div>
                    <!-- shared_buffers_fill_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.shared_buffers_fill_ratio">
                                Shared Buffers Fill Ratio
                            </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The fill ratio of the shared_buffers. The supported range is [0.95, 1.0], default is 0.995 which meant that 99.5% capacity of shared_buffers is occupied. We did not recommended this value to be lower than 0.99 as it could lead to non-optimal memory estimation. For example, on a server with 16 GiB of RAM with 25% shared_buffers, the 99% of fill ratio meant that your server still have 40.96 MiB of shared_buffers free."
                               title="Shared Buffers Fill Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.shared_buffers_fill_ratio"
                                   id="keywords.shared_buffers_fill_ratio_range"
                                   max="1.0" min="0.95" step="0.0025" value="0.995" type="range"
                                   onchange="syncSliderToNumber('keywords.shared_buffers_fill_ratio')">
                            <input class="form-control w-auto" id="keywords.shared_buffers_fill_ratio"
                                   max="1.0" min="0.95" step="0.0025" value="0.995" type="number"
                                   onchange="syncNumberToSlider('keywords.shared_buffers_fill_ratio')">
                        </div>
                    </div>

                    <!-- max_work_buffer_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_work_buffer_ratio"> Max Work Buffer Pool Ratio </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of the maximum PostgreSQL available memory (excluding shared_buffers and others) to be used in the session-based variable: temp_buffers and work_mem (globally managed). The supported range is (0, 0.75], default is 0.15. The algorithm is temp_buffers + work_mem = (pgmem_available * max_work_buffer_ratio) / active_user_connections."
                               title="Max Work Buffer Pool Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_work_buffer_ratio"
                                   id="keywords.max_work_buffer_ratio_range"
                                   max="0.75" min="0.01" step="0.01" value="0.15" type="range"
                                   onchange="syncSliderToNumber('keywords.max_work_buffer_ratio')">
                            <input class="form-control w-auto" id="keywords.max_work_buffer_ratio"
                                   max="0.75" min="0.01" step="0.01" value="0.15" type="number"
                                   onchange="syncNumberToSlider('keywords.max_work_buffer_ratio')">
                        </div>
                    </div>
                    <!-- effective_connection_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.effective_connection_ratio">
                                Effective Connection Ratio </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The percentage of the maximum non-reserved connection used to tune temp_buffers and work_mem. The supported range is [0.25, 1], default is 0.75. Set to 1 meant that we assume all the normal connections use the same temp_buffers and work_mem. Reduce this ratio would increase the temp_buffers and work_mem allowed for each connection by assuming not all active connections are running complex queries that requires high work_mem or temp_buffers."
                               title="Effective Connection Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.effective_connection_ratio"
                                   id="keywords.effective_connection_ratio_range"
                                   max="1" min="0.25" step="0.01" value="0.75" type="range"
                                   onchange="syncSliderToNumber('keywords.effective_connection_ratio')">
                            <input class="form-control w-auto" id="keywords.effective_connection_ratio"
                                   max="1" min="0.25" step="0.01" value="0.75" type="number"
                                   onchange="syncNumberToSlider('effective_connection_ratio')">
                        </div>
                    </div>
                    <!-- temp_buffers_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.temp_buffers_ratio"> Temp Buffers Ratio </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of temp_buffers to the work_buffer pool above. The supported range is [0.25, 0.95], default is 2/3. Increase this value make the temp_buffers larger than the work_mem. If you have query that use much temporary object (temporary table, CTE, ...) then you can increase this value slowly (1-3% increment is recommended). If you have query involving more WRITE and/or the WRITE query plan is complex involving HASH, JOIN, MERGE, ... then it is better to decrease this value (1-3% decrement is recommended)."
                               title="Temp Buffers Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.temp_buffers_ratio"
                                   id="keywords.temp_buffers_ratio_range"
                                   max="0.95" min="0.25" step="0.01" value="0.66" type="range"
                                   onchange="syncSliderToNumber('keywords.temp_buffers_ratio')">
                            <input class="form-control w-auto" id="keywords.temp_buffers_ratio"
                                   max="0.95" min="0.25" step="0.01" value="0.66" type="number"
                                   onchange="syncNumberToSlider('keywords.temp_buffers_ratio')">
                        </div>
                    </div>
                    <!-- work_mem_scale_factor -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.work_mem_scale_factor"> Work Memory Scale Factor </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The scale factor of the work_mem. This property should only be changed if the result of our global formula does not meet your expectation, and it is dedicated to the work_mem only. Note that setting this attribute over 1.0 would make sum(temp_buffers + work_mem) with the active_user_connections exceed the defined max_work_buffer_ratio. The supported range is (0, 3.0], default is 1.0. Only change it if you push the HASH, SORT, JOIN, or MERGE managed by the database instead of the application."
                               title="Work Memory Scale Factor">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.work_mem_scale_factor"
                                   id="keywords.work_mem_scale_factor_range"
                                   max="3.0" min="0.1" step="0.1" value="1.0" type="range"
                                   onchange="syncSliderToNumber('keywords.work_mem_scale_factor')">
                            <input class="form-control w-auto" id="keywords.work_mem_scale_factor"
                                   max="3.0" min="0.1" step="0.1" value="1.0" type="number"
                                   onchange="syncNumberToSlider('keywords.work_mem_scale_factor')">
                        </div>
                    </div>

                    <!-- max_normal_memory_usage -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_normal_memory_usage"> Max Normal Memory Usage </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The maximum memory usage under normal PostgreSQL operation over the usable memory. This holds as the upper bound to increase the variable before reaching the limit. The supported range is [0.35, 0.85], default is 0.60. Increase this ratio meant you are expecting your server would have more headroom for the tuning and thus for database workload. It is not recommended to set this value too high, as there are multiple constraints that prevent further tuning to keep your server function properly without unknown incident such as parallelism, maintenance, and other background tasks."
                               title="Max Normal Memory Usage">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_normal_memory_usage"
                                   id="keywords.max_normal_memory_usage_range"
                                   max="0.85" min="0.35" step="0.01" value="0.60" type="range"
                                   onchange="syncSliderToNumber('keywords.max_normal_memory_usage')">
                            <input class="form-control w-auto" id="keywords.max_normal_memory_usage"
                                   max="0.85" min="0.35" step="0.01" value="0.60" type="number"
                                   onchange="syncNumberToSlider('max_normal_memory_usage')">
                        </div>
                    </div>
                    <!-- memory_precision_epsilon_to_rollback -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.memory_precision_epsilon_to_rollback">
                                Memory Precision Epsilon to Rollback </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="A small epsilon value if the memory tuning does not exceeded max_normal_memory_usage + epsilon to perform a rollback. We recommend this value to be small. The supported range is [0, 0.02], and default to 1e-2 (1.0%). If the result exceeded, we trigger the rollback to get the previous iteration."
                               title="Memory Precision Epsilon to Rollback">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.memory_precision_epsilon_to_rollback"
                                   id="keywords.memory_precision_epsilon_to_rollback_range"
                                   max="0.02" min="0.0" step="0.001" value="0.01" type="range"
                                   onchange="syncSliderToNumber('keywords.memory_precision_epsilon_to_rollback')">
                            <input class="form-control w-auto" id="keywords.memory_precision_epsilon_to_rollback"
                                   max="0.02" min="0.0" step="0.001" value="0.01" type="number"
                                   onchange="syncNumberToSlider('keywords.memory_precision_epsilon_to_rollback')">
                        </div>
                    </div>
                    <!-- memory_precision_tuning_increment -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.memory_precision_tuning_increment">
                                Memory Precision Tuning Increment </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The single increment for the memory tuning in correction tuning of shared_buffer_ratio and max_work_buffer_ratio, which impacted to shared_buffers, temp_buffers, work_mem, wal_buffers, effective_cache_size, ... . A lower value means the tuning is more precise but slower. Supported value is [1/2000, 1/100] and default is 1/240. Higher value meant there may have a small room for rollback."
                               title="Memory Precision Tuning Increment">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.memory_precision_tuning_increment"
                                   id="keywords.memory_precision_tuning_increment_range"
                                   max="0.01" min="0.0005" step="0.0001" value="0.0036" type="range"
                                   onchange="syncSliderToNumber('keywords.memory_precision_tuning_increment')">
                            <input class="form-control w-auto" id="keywords.memory_precision_tuning_increment"
                                   max="0.01" min="0.0005" step="0.0001" value="0.0036" type="number"
                                   onchange="syncNumberToSlider('keywords.memory_precision_tuning_increment')">
                        </div>
                    </div>
                    <!-- memory_precision_tuning_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.memory_precision_tuning_ratio">
                                Memory Precision Tuning Ratio </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of the memory tuning in correction tuning of shared_buffer_ratio and max_work_buffer_ratio. Supported value is [0, 1] and default is 0.5. Higher value meant the tuning would prefer the shared_buffers over the max_work_buffer_ratio. Lower value meant the tuning would prefer the max_work_buffer_ratio over the shared_buffers."
                               title="Memory Precision Tuning Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.memory_precision_tuning_ratio"
                                   id="keywords.memory_precision_tuning_ratio_range"
                                   max="1.0" min="0.0" step="0.01" value="0.5" type="range"
                                   onchange="syncSliderToNumber('keywords.memory_precision_tuning_ratio')">
                            <input class="form-control w-auto" id="keywords.memory_precision_tuning_ratio"
                                   max="1.0" min="0.0" step="0.01" value="0.5" type="number"
                                   onchange="syncNumberToSlider('keywords.memory_precision_tuning_ratio')">
                        </div>
                    </div>
                    <!-- memory_precision_max_iterations -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.memory_precision_max_iterations">
                                Memory Precision Max Iterations </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The maximum number of iteration for the memory tuning. The supported range is [0, 1000] and default is 100. Set to 0 to run infinitely until the memory tuning is converged. Higher value could make the tuning run more loops."
                               title="Memory Precision Max Iterations">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.memory_precision_max_iterations"
                                   id="keywords.memory_precision_max_iterations_range"
                                   max="1000" min="0" step="20" value="100" type="range"
                                   onchange="syncSliderToNumber('keywords.memory_precision_max_iterations')">
                            <input class="form-control w-auto" id="keywords.memory_precision_max_iterations"
                                   max="1000" min="0" step="20" value="100" type="number"
                                   onchange="syncNumberToSlider('keywords.memory_precision_max_iterations')">
                        </div>
                    </div>

                    <!-- max_query_length_in_bytes -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_query_length_in_bytes">
                                Max Query Length (Bytes) </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The maximum allowed query length in bytes for logging."
                               title="Max Query Length (Bytes)">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_query_length_in_bytes"
                                   id="keywords.max_query_length_in_bytes_range"
                                   max="67108864" min="64" step="64" value="2048" type="range"
                                   onchange="syncSliderToNumber('keywords.max_query_length_in_bytes')">
                            <input class="form-control w-auto" id="keywords.max_query_length_in_bytes"
                                   max="67108864" min="64" step="64" value="2048" type="number"
                                   onchange="syncNumberToSlider('keywords.max_query_length_in_bytes')">
                        </div>
                    </div>
                    <!-- max_runtime_ms_to_log_slow_query -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_runtime_ms_to_log_slow_query">
                                Max Runtime to Log Slow Query (ms) </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The maximum runtime in milliseconds to consider a query slow and log it."
                               title="Max Runtime to Log Slow Query (ms)">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_runtime_ms_to_log_slow_query"
                                   id="keywords.max_runtime_ms_to_log_slow_query_range"
                                   max="100000" min="20" step="10" value="2000" type="range"
                                   onchange="syncSliderToNumber('keywords.max_runtime_ms_to_log_slow_query')">
                            <input class="form-control w-auto" id="keywords.max_runtime_ms_to_log_slow_query"
                                   max="100000" min="20" step="10" value="2000" type="number"
                                   onchange="syncNumberToSlider('keywords.max_runtime_ms_to_log_slow_query')">
                        </div>
                    </div>
                    <!-- max_runtime_ratio_to_explain_slow_query -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_runtime_ratio_to_explain_slow_query">
                                Max Runtime Ratio to Explain Slow Query </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of runtime for automatically explaining slow queries."
                               title="Max Runtime Ratio to Explain Slow Query">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_runtime_ratio_to_explain_slow_query"
                                   id="keywords.max_runtime_ratio_to_explain_slow_query_range"
                                   max="10.0" min="0.1" step="0.1" value="1.5" type="range"
                                   onchange="syncSliderToNumber('keywords.max_runtime_ratio_to_explain_slow_query')">
                            <input class="form-control w-auto" id="keywords.max_runtime_ratio_to_explain_slow_query"
                                   max="10.0" min="0.1" step="0.1" value="1.5" type="number"
                                   onchange="syncNumberToSlider('keywords.max_runtime_ratio_to_explain_slow_query')">
                        </div>
                    </div>

                    <!-- wal_segment_size -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.wal_segment_size"> WAL Segment Size (per 16 MiB) </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The WAL segment size in PostgreSQL (in MiB). The supported range is [16, 2048] in MiB. Whilst the tuning of this value is not recommended as mentioned in due to some hard-coded in 3rd-party tools, and benefits of WAL recovering, archiving, and transferring; longer WAL initialization during burst workload. Unless you run initdb with custom wal_segment_size (64 MiB or larger); I still leave it here for you to adjust. For the best practice, whilst 16 MiB of single WAL file is good for most cases; a scenario where you needed higher WAL size is when dealing with OLTP workload with large amount of data write that would rotate the WAL too frequently. Also, the benchmarking from PostgreSQL team does show improvement but at when the number of connections are large (> 64) with larger than 64 vCPU. Beyond that, the improvement are marginal and you could have same benefit when tuning other variables. Just to remember to adjust the max_wal_size, archive_timeout, and checkpoint_timeout to better suit your workload."
                               title="WAL Segment Size (per 16 MiB)">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.wal_segment_size"
                                   id="keywords.wal_segment_size_range"
                                   max="128" min="1" step="1" value="1" type="range"
                                   onchange="syncSliderToNumber('keywords.wal_segment_size')">
                            <input class="form-control w-auto" id="keywords.wal_segment_size"
                                   max="128" min="1" step="1" value="1" type="number"
                                   onchange="syncNumberToSlider('keywords.wal_segment_size')">
                            <label class="form-label mx-3" for="keywords.wal_segment_size"> x16 MiB </label>
                        </div>
                    </div>
                    <!-- min_wal_ratio_scale -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.min_wal_ratio_scale"> Min WAL Ratio Scale </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The WAL ratio scaler for tune the min_wal_size configuration. The min_wal_size is computed by take this argument and multiply with remaining storage. Setting this value beyond 1.0 meant that the min_wal_size (threshold) would be larger than the max_wal_size. The maximum value of min_wal_size is depending on the smallest ratio of max_wal_size (defined in the source). The supported range is [0.05, 3.0], default is 0.5."
                               title="Min WAL Ratio Scale">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.min_wal_ratio_scale"
                                   id="keywords.min_wal_ratio_scale_range"
                                   max="3" min="0.01" step="0.01" value="0.5" type="range"
                                   onchange="syncSliderToNumber('keywords.min_wal_ratio_scale')">
                            <input class="form-control w-auto" id="keywords.min_wal_ratio_scale"
                                   max="3" min="0.05" step="0.05" value="0.5" type="number"
                                   onchange="syncNumberToSlider('keywords.min_wal_ratio_scale')">
                        </div>
                    </div>
                    <!-- max_wal_size_ratio -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_wal_size_ratio"> Max WAL Size Ratio </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The ratio of the max_wal_size against the total WAL volume. The supported range is between 0.0 and 1.0 (exclusive on two end), default is 0.90."
                               title="Max WAL Size Ratio">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_wal_size_ratio"
                                   id="keywords.max_wal_size_ratio_range"
                                   max="0.99" min="0.01" step="0.01" value="0.90" type="range"
                                   onchange="syncSliderToNumber('keywords.max_wal_size_ratio')">
                            <input class="form-control w-auto" id="keywords.max_wal_size_ratio"
                                   max="0.99" min="0.01" step="0.01" value="0.90" type="number"
                                   onchange="syncNumberToSlider('keywords.max_wal_size_ratio')">
                        </div>
                    </div>
                    <!-- max_wal_size_remain_upper_size -->
                    <div class="col-4 mb-3">
                        <div class="d-flex justify-content-between align-items-center">
                            <label class="form-label" for="keywords.max_wal_size_remain_upper_size_in_gib">
                                Max WAL Size Remaining Upper Limit (GiB) </label>
                            <i class="bi bi-info-circle text-primary align-items-left" data-bs-toggle="popover"
                               data-bs-trigger="hover focus" role="button" tabindex="0" data-bs-placement="auto"
                               data-bs-content="The upper bound of free space from max_wal_size value to the WAL volume capacity. It is set to ensure that you can maximize the WAL partition better and prevent frequent changes on ratio. If the remaining space exceeded this capacity, the max_wal_size is adjusted to the total storage minus this value. Whilst this value could be different across workloads, it is OK to set this value a little bit high when you work on SSD where its performance corresponding to the remaining space (especially on the NVME QLC SSD, TLC and MLC usually have less impact). The minimum value is 1 GiB and the default is 256 GiB, and must be a multiple of 256 MiB. For example if the ratio is 0.9 and upper size is 256 GiB, then the disk size must be larger 256 Gi / (1 - 0.9) ~ 2.5 TiB to have max_wal_size is 256 GiB less than the disk size."
                               title="Max WAL Size Remaining Upper Limit (GiB)">
                            </i>
                        </div>
                        <div class="d-flex align-items-center">
                            <input class="form-range me-3" name="keywords.max_wal_size_remain_upper_size_in_gib"
                                   id="keywords.max_wal_size_remain_upper_size_in_gib_range"
                                   max="2048" min="1" step="1" value="256" type="range"
                                   onchange="syncSliderToNumber('keywords.max_wal_size_remain_upper_size_in_gib')">
                            <input class="form-control w-auto" id="keywords.max_wal_size_remain_upper_size_in_gib"
                                   max="2048" min="1" step="1" value="256" type="number"
                                   onchange="syncNumberToSlider('keywords.max_wal_size_remain_upper_size_in_gib')">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Generate Button and Response Box -->
    <div class="my-3">

        <div class="row">
            <div class="col-2 d-flex align-items-start justify-content-center">
                <button id="generate-config" class="btn btn-primary" onclick="submitConfiguration()">
                    Generate Configuration</button>
            </div>
            <div class="col-10">
                <div class="d-flex my-2 justify-content-start">
                    <label class="form-label" for="response-box">Generated Configuration</label>
                </div>
                <div class="d-flex my-2 justify-content-end">
                    <button class="btn btn-outline-secondary mb-3 mx-3 " onclick="copyToClipboard()">Copy to Clipboard</button>
                    <button class="btn btn-outline-secondary mb-3" onclick="downloadResponse()">Download</button>
                </div>
                <textarea id="response-box" class="form-control object-fit-fill bordered rounded" rows="32" readonly
                          placeholder="Response will appear here..." onchange="autoresize()"></textarea>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    function syncNumberToSlider(id) {
        const slider = document.getElementById(id + "_range");
        const numberInput = document.getElementById(id);
        let result = Math.min(Math.max(numberInput.min, numberInput.value), numberInput.max);
        slider.value = result;
        numberInput.value = result;
    }
    function syncSliderToNumber(id) {
        const slider = document.getElementById(id + "_range");
        const numberInput = document.getElementById(id);
        let result = Math.min(Math.max(slider.min, slider.value), slider.max);
        numberInput.value = result;
        slider.value = result;
    }

    function syncLabelFromCheckbox(id, yes_text, no_text) {
        document.getElementById(id).addEventListener('change', function() {
            if (!this.checked) {
                this.nextElementSibling.textContent = no_text;
            } else {
                this.nextElementSibling.textContent = yes_text;
            }
        });
    }
    const checkboxList = document.querySelectorAll('.form-check-input');
    checkboxList.forEach(checkbox => {
        syncLabelFromCheckbox(checkbox.id, 'Yes', 'No');
    });

    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })
    const popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
    const popoverList = popoverTriggerList.map(popoverTriggerEl => new bootstrap.Popover(popoverTriggerEl))

    function preprocessParameters(params) {
        const nestedParams = {};

        for (const [key, value] of Object.entries(params)) {
            if (key.includes('.')) {
                const keys = key.split('.');
                let current = nestedParams;

                for (let i = 0; i < keys.length; i++) {
                    const part = keys[i];

                    if (i === keys.length - 1) {
                        current[part] = value;
                    } else {
                        current[part] = current[part] || {};
                        current = current[part];
                    }
                }
            } else {
                nestedParams[key] = value;
            }
        }

        return nestedParams;
    }

    function gatherFormValues() {
        const formElements = document.querySelectorAll('[name]');
        const params = {};

        formElements.forEach(el => {
            if (el.type === 'range' || el.type === 'number') {
                // parseFloat if element.step in string has dot, parseInt
                params[el.name] = el.step.includes('.') ? parseFloat(el.value) : parseInt(el.value);
            } else if (el.type === 'text') {
                params[el.name] = el.value;
            } else if (el.type === 'select-one') {
                params[el.name] = el.value;
            }
        });

        // Add checkbox and select values
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => {
            params[checkbox.id] = checkbox.checked;
        });

        return params;
    }

    async function submitConfiguration() {
        const rawParams = gatherFormValues();
        const processedParams = preprocessParameters(rawParams);
        let body = {
            'user_options': processedParams,
            'alter_style': document.getElementById('alter_style').checked,
            'backup_settings': document.getElementById('backup_settings').checked,
            'output_format': document.getElementById('output_format').value,
        };
        body = JSON.stringify(body, null, 2);
        console.log(body)

        try {
            const response = await fetch('/tune', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: body
            });

            if (response.ok) {
                // If the response is successful, show the result based on its content-type
                if (response.headers.get('content-type').includes('application/json')) {
                    const result = await response.json();
                    console.log(result);
                    const responseBox = document.getElementById('response-box');
                    responseBox.readOnly = false;
                    responseBox.innerHTML = '';
                    responseBox.innerHTML = JSON.stringify(result, null, 2);
                    responseBox.readOnly = true;
                } else if (response.headers.get('content-type').includes('text/plain')) {
                    const result = await response.text();
                    console.log(result);
                    const responseBox = document.getElementById('response-box');
                    responseBox.readOnly = false;
                    responseBox.innerHTML = '';
                    responseBox.innerHTML = result;
                    responseBox.readOnly = true;
                }
            } else {
                const error = await response.text();
                console.error('Error:', error);
                alert('Failed to generate configuration.');
            }
        } catch (err) {
            console.error('Request failed:', err);
            alert('An error occurred. Please try again.');
        }
    }

    function copyToClipboard() {
        const responseBox = document.getElementById('response-box');
        responseBox.select();
        document.execCommand('copy');
        alert('Response copied to clipboard!');
    }

    function downloadResponse() {
        const responseBox = document.getElementById('response-box');
        const blob = new Blob([responseBox.value], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'response.txt';
        a.click();
        URL.revokeObjectURL(url);
    }
</script>
</html>